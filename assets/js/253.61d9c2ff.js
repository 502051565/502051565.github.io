(window.webpackJsonp=window.webpackJsonp||[]).push([[253],{1310:function(s,t,a){"use strict";a.r(t);var n=a(17),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"mysql-索引与事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-索引与事务"}},[s._v("#")]),s._v(" MySQL 索引与事务")]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#mysql索引-index"}},[s._v("mysql索引(index)")]),a("ul",[a("li",[a("a",{attrs:{href:"#索引快速入门"}},[s._v("索引快速入门")])]),a("li",[a("a",{attrs:{href:"#索引的原理"}},[s._v("索引的原理")])]),a("li",[a("a",{attrs:{href:"#索引的类型"}},[s._v("索引的类型")])]),a("li",[a("a",{attrs:{href:"#索引使用"}},[s._v("索引使用")])]),a("li",[a("a",{attrs:{href:"#小结-哪些列上适合使用索引"}},[s._v("小结：哪些列上适合使用索引")])])])]),a("li",[a("a",{attrs:{href:"#mysql事务"}},[s._v("mysql事务")]),a("ul",[a("li",[a("a",{attrs:{href:"#什么是事务"}},[s._v("什么是事务")])]),a("li",[a("a",{attrs:{href:"#事务和锁"}},[s._v("事务和锁")])]),a("li",[a("a",{attrs:{href:"#回退事务"}},[s._v("回退事务")])]),a("li",[a("a",{attrs:{href:"#提交事务"}},[s._v("提交事务")])]),a("li",[a("a",{attrs:{href:"#事务细节讨论"}},[s._v("事务细节讨论")])])])]),a("li",[a("a",{attrs:{href:"#mysql-事务隔离级别"}},[s._v("mysql 事务隔离级别")]),a("ul",[a("li",[a("a",{attrs:{href:"#事务隔离级别介绍"}},[s._v("事务隔离级别介绍")])]),a("li",[a("a",{attrs:{href:"#查看事务隔离级别"}},[s._v("查看事务隔离级别")])]),a("li",[a("a",{attrs:{href:"#事务隔离级别"}},[s._v("事务隔离级别")])]),a("li",[a("a",{attrs:{href:"#设置事务隔离级别"}},[s._v("设置事务隔离级别")])])])]),a("li",[a("a",{attrs:{href:"#mysql-事务-acid"}},[s._v("mysql 事务 ACID")]),a("ul",[a("li",[a("a",{attrs:{href:"#事务的-acid-特性"}},[s._v("事务的 acid 特性")])])])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"mysql索引-index"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql索引-index"}},[s._v("#")]),s._v(" mysql索引(index)")]),s._v(" "),a("h3",{attrs:{id:"索引快速入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引快速入门"}},[s._v("#")]),s._v(" 索引快速入门")]),s._v(" "),a("ol",[a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("说起提高数据库性能,索引是最物美价廉的东西了。不用加内存，不用改程序,不用调sql，查询速度就可能提高百倍干倍。")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("没有建立索引的字段，查询起来依旧很慢")])],1)]),s._v(" "),a("h3",{attrs:{id:"索引的原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引的原理"}},[s._v("#")]),s._v(" 索引的原理")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/50.png",loading:"lazy"}})]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/51.png",loading:"lazy"}})]),s._v(" "),a("ol",[a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("没有索引为什么会慢?因为全表扫描.")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("使用索引为什么会快?形成一个索引的数据结构，比如二叉树")])],1)]),s._v(" "),a("ul",[a("li",[s._v("索引的代价\n"),a("ol",[a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("磁盘占用")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("对dml(update delete insert)语句的效率影响,")])],1)])])]),s._v(" "),a("h3",{attrs:{id:"索引的类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引的类型"}},[s._v("#")]),s._v(" 索引的类型")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/52.png",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"索引使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引使用"}},[s._v("#")]),s._v(" 索引使用")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/53.png",loading:"lazy"}})]),s._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[a("strong",[s._v("查询索引（三种方式）")])])]),s._v(" "),a("p",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("show index(ex) from table_name;")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("show keys from table_name;")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("desc table_Name;")])],1),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 演示mysql的索引的使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\t\n\tid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\n\t\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询表是否有索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" INDEXES "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 添加索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 添加唯一索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" id_index "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" t25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 添加普通索引方式1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" id_index "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" t25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 如何选择")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1.如果某列的值，是不会重复的，则优先考虑使用unique索引,否则使用普通索引")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 添加普通索引方式2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t25 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" id_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 添加主键索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t26"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\t\n\tid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1. primary key")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 2.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t26 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t26\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t25\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" id_index "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" t25\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除主键索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t26 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 修改索引，先删除，在添加新的索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1.方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t25\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 2.方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" INDEXES "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t25\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 3.方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEYS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t25\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 4.方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DESC")]),s._v(" t25\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建一张订单表order (id号，商品名,订购人，数量).")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 要求id号为主键，请使用2种方式来创建主键.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- (提示:为练习方便，可以是order1 , order2 )")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("goods_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\tperson "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\tnum "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 方式一")]),s._v("\n\t\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 方式二")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建一张特价菜谱表menu(id号，菜谱名,厨师，点餐人身份证，价格).")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 要求id号为主键，点餐人身份证是unique请使用两种方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 来创建unique.(提示:为练习方便，可以是menu1 , menu2")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" menu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t 厨师 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t身份证 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\tprice "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DOUBLE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 方式一")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" 身份证 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" menu "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("身份证"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" menu\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建一张运动员表sportman (id号，名字，特长).")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 要求id号为主键，名字为普通索引，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 请使用2种方式来创建索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- (提示:为练习方便，可以是不同表名sportman1 , sportman2")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" sportman"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\thobby "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" name_index "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" sportman"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 方式一")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" sportman "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" name_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 方式二")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br")])]),a("h3",{attrs:{id:"小结-哪些列上适合使用索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结-哪些列上适合使用索引"}},[s._v("#")]),s._v(" 小结：哪些列上适合使用索引")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/54.png",loading:"lazy"}})]),s._v(" "),a("h2",{attrs:{id:"mysql事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql事务"}},[s._v("#")]),s._v(" mysql事务")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/55.png",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"什么是事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是事务"}},[s._v("#")]),s._v(" 什么是事务")]),s._v(" "),a("p",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("事务用于保证数据的一致性,它由一组相关的dml语句组成,该组的dml语句要么全部成功，要么全部失败。如:转账就要用事务来处理,用以保证数据的一致性。")])],1),s._v(" "),a("h3",{attrs:{id:"事务和锁"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务和锁"}},[s._v("#")]),s._v(" 事务和锁")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/56.png",loading:"lazy"}})]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 事务的一个重要的概念和具体操作")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 演示")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1.创建一张测试表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 2.开始事务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("START")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 3.设置保存点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SAVEPOINT")]),s._v(" a\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 执行dml操作")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t27 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tom'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SAVEPOINT")]),s._v(" b\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 执行dml操作")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t27 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jack'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 回退到b")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" b\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 继续回退 a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" a\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 如果这样，表示直接回退到事务开始的状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMIT")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h3",{attrs:{id:"回退事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回退事务"}},[s._v("#")]),s._v(" 回退事务")]),s._v(" "),a("p",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("在介绍回退事务前，先介绍一下保存点(savepoint).保存点是事务中的点.用于取消部分事务，当结束事务时(commit),会自动的删除该事务所定义的所有保存点.当执行回退事务时，通过指定保存点可以回退到指定的点。")])],1),s._v(" "),a("h3",{attrs:{id:"提交事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提交事务"}},[s._v("#")]),s._v(" 提交事务")]),s._v(" "),a("p",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("使用commit语句可以提交事务.当执行了commit语句子后,会确认事务的变化、结金事除徨专野放锁数据生效。当使用commit语句结束事务子后，其它会话[其他连接]将可以查着到事务变化后的新数据[所有数据就正式生效.]")])],1),s._v(" "),a("h3",{attrs:{id:"事务细节讨论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务细节讨论"}},[s._v("#")]),s._v(" 事务细节讨论")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/57.png",loading:"lazy"}})]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 讨论事务细节")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1.如果不开始事务，默认情况下，dml操作是自动提交的，不能回滚")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t27 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'milan'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 自动提交commit")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t27\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 2.如果开始一个事务，你没有创建保存点.你可以执行rollback,")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 默认就是回退到你事务开始的状态.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("START")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t27 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'king'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t27 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'scott'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ROLLBACK")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 表示直接回退到事务开始的状态")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 3.你也可以在这个事务中(还没有提交时),创建多个保存点.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 比如: savepoint aaa;执行dml , savepoint bbb;")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 4.你可以在事务没有提交前，选择回退到哪个保存点.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 5.mysql的事务机制需要innodb的存储引擎才可以使用,myisam不支持.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 6.开始一个事务start transaction, set autocommit=off;")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"mysql-事务隔离级别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-事务隔离级别"}},[s._v("#")]),s._v(" mysql 事务隔离级别")]),s._v(" "),a("h3",{attrs:{id:"事务隔离级别介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务隔离级别介绍"}},[s._v("#")]),s._v(" 事务隔离级别介绍")]),s._v(" "),a("ol",[a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("多个连接开启各自事务操作数据库中数据时，数据库系统要负责隔离操作，以保证各个连接在获取数据时的准确性。")]),s._v("（通俗解释)")],1),s._v(" "),a("li",[s._v("如果不考虑隔离性,可能会引发如下问题:\n"),a("ul",[a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("脏读")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("不可重复读")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("幻读")])],1)])])]),s._v(" "),a("h3",{attrs:{id:"查看事务隔离级别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看事务隔离级别"}},[s._v("#")]),s._v(" 查看事务隔离级别")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/58.png",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"事务隔离级别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务隔离级别"}},[s._v("#")]),s._v(" 事务隔离级别")]),s._v(" "),a("p",[s._v("概念:Mysql隔离级别定义了"),a("strong",[s._v("事务与事务之间的隔离程度。")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Mysql隔离级别(4种)")]),s._v(" "),a("th",[s._v("脏读")]),s._v(" "),a("th",[s._v("不可重复读")]),s._v(" "),a("th",[s._v("幻读")]),s._v(" "),a("th",[s._v("加锁读")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("读未提交(Read uncommited)")]),s._v(" "),a("td",[s._v("√")]),s._v(" "),a("td",[s._v("√")]),s._v(" "),a("td",[s._v("√")]),s._v(" "),a("td",[s._v("不加锁")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("读已提交(Read commited)")])]),s._v(" "),a("td",[s._v("×")]),s._v(" "),a("td",[s._v("√")]),s._v(" "),a("td",[s._v("√")]),s._v(" "),a("td",[s._v("不加锁")])]),s._v(" "),a("tr",[a("td",[s._v("可重复读(Repeatable)")]),s._v(" "),a("td",[s._v("×")]),s._v(" "),a("td",[s._v("×")]),s._v(" "),a("td",[s._v("√")]),s._v(" "),a("td",[s._v("不加锁")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("可串行化(Serializable)")])]),s._v(" "),a("td",[s._v("×")]),s._v(" "),a("td",[s._v("×")]),s._v(" "),a("td",[s._v("×")]),s._v(" "),a("td",[s._v("加锁")])])])]),s._v(" "),a("p",[s._v("说明：√可能出现 ×不会出现")]),s._v(" "),a("h3",{attrs:{id:"设置事务隔离级别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置事务隔离级别"}},[s._v("#")]),s._v(" 设置事务隔离级别")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/59.png",loading:"lazy"}})]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 演示mysql的事务隔离级别")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1.开启两个mysql的控制台")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 2.查看当前mysql的隔离级别")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" @"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@tx_isolation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- mysql> SELECT @@tx_isolation;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- +-----------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- | @@tx_isolation  |")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- +-----------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- | REPEATABLE-READ |")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- +-----------------+")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 3.把其中一个控制台的隔离级别设置 Read uncommitted")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SESSION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ISOLATION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEVEL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("READ")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNCOMMITTED")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- mysql> SELECT @@tx_isolation;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- +------------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- | @@tx_isolation   |")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- +------------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- | READ-UNCOMMITTED |")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- +------------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1 row in set (0.00 sec)")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 4.创建表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("account"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tid "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\tmoney "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\n\t\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看当前会话隔离级别")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" @"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@tx_isolation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看系统当前隔离级别")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" @@ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tx_isplation\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 设置当前会话隔离级别")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SESSION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ISOLATION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEVEL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("READ")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNCOMMITTED")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 设置系统当前隔离级别")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TRANSACTION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ISOLATION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEVEL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("设置你想设置的级别"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/60.png",loading:"lazy"}})]),s._v(" "),a("p",[a("strong",[s._v("左边的事务没有提交，但是右边可以看到左边添加的100用户信息，这就是脏读")])]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"04","data-src":"https://cdn.staticaly.com/gh/xustudyxu/image-hosting@master/studynotes/MySQL/images/61.png",loading:"lazy"}})]),s._v(" "),a("p",[a("strong",[s._v("左边的事务经过修改和添加，但是提交了，右边依然可以看到修改和添加的信息，这就是不可重复度和幻读，因为左边的提交已经直接影响到了右边的操作。")])]),s._v(" "),a("h2",{attrs:{id:"mysql-事务-acid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-事务-acid"}},[s._v("#")]),s._v(" mysql 事务 ACID")]),s._v(" "),a("h3",{attrs:{id:"事务的-acid-特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务的-acid-特性"}},[s._v("#")]),s._v(" 事务的 acid 特性")]),s._v(" "),a("ol",[a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("原子性(Atomicity)")]),s._v(" "),a("strong",[s._v("原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("一致性(Consistency)")]),s._v(" "),a("strong",[s._v("事务必须使数据库从一个一致性状态变换到另外一个一致性状态")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("隔离性(lsolation)")]),s._v(" "),a("strong",[s._v("事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"#DC4040",size:"4",face:"黑体"}},[s._v("持久性(Durability)")]),s._v(" "),a("strong",[s._v("持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响")])],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);